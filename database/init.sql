-- CREATE DATABASE
CREATE DATABASE TASKSDB;
USE TASKSDB;

-- CREATE DATAMODEL

DROP TABLE IF EXISTS LOGS_BACKEND;
CREATE TABLE LOGS_BACKEND (
  ID int NOT NULL AUTO_INCREMENT,
  MESSAGE varchar(5000) NOT NULL,
  DATE date NOT NULL,
  PRIMARY KEY (ID)
);

DROP TABLE IF EXISTS USERS;
CREATE TABLE USERS (
  ID int NOT NULL AUTO_INCREMENT,
  USERNAME varchar(255) NOT NULL,
  PASSWORD varchar(255) NOT NULL,
  PRIMARY KEY (ID)
);

DROP TABLE IF EXISTS TASKS;
CREATE TABLE TASKS (
  ID int NOT NULL AUTO_INCREMENT,
  NAME varchar(255),
  DESCRIPTION varchar(2000),
  STATUS varchar(255),
  DATE_START datetime,
  DATE_END datetime,
  USER_ID int,
  CONSTRAINT `FK_TASK_USERS` FOREIGN KEY (USER_ID) REFERENCES USERS (ID),
  PRIMARY KEY (ID)
);


-- CREATE STORED PROCEDURES
DELIMITER ;;

DROP PROCEDURE IF EXISTS `SP_INSERT_LOG_BACKEND`;;
CREATE PROCEDURE `SP_INSERT_LOG_BACKEND`(IN `Message` varchar(5000))
INSERT INTO LOGS_BACKEND(MESSAGE, DATE) VALUES (Message, NOW());;

DROP PROCEDURE IF EXISTS `SP_RETRIEVE_ALL_TASKS`;;
CREATE PROCEDURE `SP_RETRIEVE_ALL_TASKS`(IN `initial` int, IN `end` int)
SELECT
ID,
NAME,
DESCRIPTION,
STATUS,
DATE_START,
DATE_END

FROM TASKS
LIMIT initial, end;;

DELIMITER ;

-- INSERT MOCK DATA

INSERT INTO USERS(ID, USERNAME, PASSWORD) VALUES
(1, 'USERNAME', 'PASSWORD');

INSERT INTO TASKS (ID, NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
(1,	'TASK_NAME_1', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (ID, NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
(2,	'TASK_NAME_2', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (ID, NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
(3,	'TASK_NAME_3', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (ID, NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
(4,	'TASK_NAME_4', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (ID, NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
(5,	'TASK_NAME_5', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (ID, NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
(6,	'TASK_NAME_6', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (ID, NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
(7,	'TASK_NAME_7', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_8', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_9', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_10', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_11', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_12', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_13', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_14', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_15', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_16', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_17', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_18', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_19', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_20', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_21', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_22', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);

INSERT INTO TASKS (NAME, DESCRIPTION, STATUS, DATE_START, DATE_END, USER_ID) VALUES
('TASK_NAME_23', 'DESCRIPTION',	'STATUS',	'2019-12-31 00:00:00',	'2020-12-31 00:00:00', 1);
